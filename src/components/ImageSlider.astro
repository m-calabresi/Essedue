---
import { Image } from "astro:assets";
import type { ImageMetadata } from "astro";

import SliderIcon from "../components/icons/Slider.astro";

interface Props {
    left: {
        image: ImageMetadata;
        alt?: string;
    };
    right: {
        image: ImageMetadata;
        alt?: string;
    };
    class?: string;
}

const { left, right, class: className } = Astro.props;
---

<div
    class:list={[
        "slider-container w-full h-full group/slider-container relative overflow-hidden",
        className,
    ]}>
    <Image
        src={left.image}
        alt={left.alt ?? ""}
        class="absolute inset-0 w-[var(--slider-position)] h-full slider-image object-cover object-left-top"
    />
    <Image
        src={right.image}
        alt={right.alt ?? ""}
        class="w-full h-full slider-image object-cover object-left-top"
    />
    <input
        type="range"
        min="0"
        max="100"
        value="50"
        aria-label="Percentage of left photo shown"
        class="absolute inset-0 cursor-pointer opacity-0 w-full h-full peer/slider-handle"
        oninput="this.closest('.slider-container').style.setProperty('--slider-position', `${this.value}%`);"
    />
    <div
        class="absolute inset-0 w-1 h-full bg-white left-[var(--slider-position)] -translate-x-1/2 pointer-events-none"
        aria-hidden="true">
    </div>
    <div
        class="slider-button absolute bg-white text-black border-black border-2 p-[0.6rem] grid place-items-center top-1/2 left-[var(--slider-position)] -translate-x-1/2 -translate-y-1/2 pointer-events-none peer-focus-visible/slider-handle:ring-2 peer-focus-visible/slider-handle:ring-black peer-focus-visible/slider-handle:ring-offset-4 peer-focus-visible/slider-handle:ring-offset-white peer-focus-visible/slider-handle:bg-black peer-focus-visible/slider-handle:text-white"
        aria-hidden="true">
        <SliderIcon
            class="rotate-90 transition-all duration-300 group-hover/slider-container:w-8 group-hover/slider-container:h-8"
        />
    </div>
</div>

<style>
    .slider-container {
        --slider-position: 50%; /* initial slider position */
    }
</style>
